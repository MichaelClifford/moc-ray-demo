#!/bin/bash

echo
echo "starting ray worker..."
echo

# ray-project operator sets RAY_HEAD_IP, but not RAY_HEAD_NODE
export RAY_HEAD_NODE=${RAY_HEAD_NODE:-$RAY_HEAD_IP}

ray --logging-level=info \
    start \
    --node-ip-address=$RAY_POD_IP \
    --num-cpus=$RAY_CPU_REQUEST \
    --address=${RAY_HEAD_NODE}:6379 \
    --object-manager-port=12345 --node-manager-port=12346 \
    --log-style=record --log-color=false \
    --block
